%%
addpath ./media/calibration-data/

SN_str = "SN-2024110603";

% fname = 'x00000019.csv';
fname = sprintf( "f-dev-cal-rest-%s.csv", SN_str);
fname = which( fname);
tsc = flatball_log_proc( fname);

%%
fprintf( 'sensors at rest, mean and standard deviations\n');
fprintf( '%15s - %10s - %9s\n', 'sensor', 'mean', 'sigma');
fprintf( '%15s - %10.4f - %5.3e\n', 'acc-x', tsc.acc_x.mean, tsc.acc_x.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'acc-y', tsc.acc_y.mean, tsc.acc_y.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'acc-z', tsc.acc_z.mean, tsc.acc_z.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'gyro-x', tsc.gyro_x.mean, tsc.gyro_x.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'gyro-y', tsc.gyro_y.mean, tsc.gyro_y.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'gyro-z', tsc.gyro_z.mean, tsc.gyro_z.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'mag-x', tsc.mag_x.mean, tsc.mag_x.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'mag-y', tsc.mag_y.mean, tsc.mag_y.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'mag-z', tsc.mag_z.mean, tsc.mag_z.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'patm', tsc.patm.mean, tsc.patm.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'temp', tsc.temp.mean, tsc.temp.std);
fprintf( '%15s - %10.4f - %5.3e\n', 'altitude', tsc.altitude.mean, tsc.altitude.std);

%%
title_str = sprintf( "%s - sensor noise", SN_str);

%%
new_formatted_fig( 'fdev-dt');
tsc.dt.plot;
ylim([0.0 0.10]);
ylabel( 's');
title( title_str);

grid on;
snapnow;

%%
new_formatted_fig( 'altitude');
hold on;
tsc.altitude.plot;
hold off;
ylabel( 'm');
ylim( [tsc.altitude.min-10 tsc.altitude.max+10]);
title( title_str);

grid on;
snapnow;

%%
new_formatted_fig( 'temperature');
hold on;
tsc.temp.plot;
hold off;
ylabel( 'degC');
title( title_str);

grid on;
snapnow;
